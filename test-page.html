<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Analytics Dashboard - Test Data</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .data-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .hidden {
            display: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            padding: 8px 12px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f5f5f5;
            font-weight: 600;
        }
        .instruction {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Website Analytics Dashboard</h1>
        <p>Sample data for SankeyStone extension testing</p>
    </div>

    <div class="instruction">
        <strong>Instructions:</strong> Load the SankeyStone Chrome extension and click the extension icon while viewing this page. 
        The extension should automatically detect and visualize the traffic flow data below.
    </div>

    <div class="data-section">
        <h3>ðŸ§ª Test Controls</h3>
        <p>Use these buttons to test the extension's data extraction capabilities:</p>
        <button id="randomize-data" style="background-color: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 4px; margin-right: 10px; cursor: pointer; font-size: 14px;">ðŸŽ² Randomize Page Data</button>
        <button id="reset-data" style="background-color: #4caf50; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 14px;">ðŸ”„ Reset to Original</button>
        <p style="margin-top: 10px; font-size: 14px; color: #666;">After clicking "Randomize Page Data", use the "Refresh from Page" button in the SankeyStone extension to see the updated diagram.</p>
    </div>

    <!-- Sankey Data embedded in the page -->
    <div class="data-section">
        <h2>Traffic Flow Data</h2>
        <p>The data below represents website traffic flow from sources to pages to outcomes.</p>
        
        <!-- Data in JSON format for easy extraction -->
        <script type="application/json" id="sankey-data">
        {
            "nodes": [
                { "id": 0, "name": "Google Search", "layer": 0, "category": "traffic_source" },
                { "id": 1, "name": "Facebook", "layer": 0, "category": "traffic_source" },
                { "id": 2, "name": "Twitter", "layer": 0, "category": "traffic_source" },
                { "id": 3, "name": "Direct Traffic", "layer": 0, "category": "traffic_source" },
                { "id": 4, "name": "Homepage", "layer": 1, "category": "page" },
                { "id": 5, "name": "Product Catalog", "layer": 1, "category": "page" },
                { "id": 6, "name": "Blog", "layer": 1, "category": "page" },
                { "id": 7, "name": "Contact Page", "layer": 1, "category": "page" },
                { "id": 8, "name": "Purchase", "layer": 2, "category": "outcome" },
                { "id": 9, "name": "Newsletter Signup", "layer": 2, "category": "outcome" },
                { "id": 10, "name": "Bounce", "layer": 2, "category": "outcome" }
            ],
            "links": [
                { "source": 0, "target": 4, "value": 3200 },
                { "source": 0, "target": 5, "value": 2800 },
                { "source": 0, "target": 6, "value": 1500 },
                { "source": 1, "target": 4, "value": 1800 },
                { "source": 1, "target": 6, "value": 1200 },
                { "source": 2, "target": 4, "value": 900 },
                { "source": 2, "target": 6, "value": 1100 },
                { "source": 3, "target": 4, "value": 2200 },
                { "source": 3, "target": 5, "value": 1600 },
                { "source": 3, "target": 7, "value": 400 },
                { "source": 4, "target": 8, "value": 1200 },
                { "source": 4, "target": 9, "value": 800 },
                { "source": 4, "target": 10, "value": 6100 },
                { "source": 5, "target": 8, "value": 1800 },
                { "source": 5, "target": 9, "value": 400 },
                { "source": 5, "target": 10, "value": 3200 },
                { "source": 6, "target": 9, "value": 1200 },
                { "source": 6, "target": 10, "value": 2600 },
                { "source": 7, "target": 9, "value": 150 },
                { "source": 7, "target": 10, "value": 250 }
            ]
        }
        </script>
    </div>

    <!-- Alternative: Data in HTML table format -->
    <div class="data-section">
        <h3>Traffic Sources</h3>
        <table class="traffic-sources" data-sankey-layer="0">
            <thead>
                <tr>
                    <th>Source</th>
                    <th>Visitors</th>
                </tr>
            </thead>
            <tbody>
                <tr data-node-id="0">
                    <td>Google Search</td>
                    <td>7,500</td>
                </tr>
                <tr data-node-id="1">
                    <td>Facebook</td>
                    <td>3,000</td>
                </tr>
                <tr data-node-id="2">
                    <td>Twitter</td>
                    <td>2,000</td>
                </tr>
                <tr data-node-id="3">
                    <td>Direct Traffic</td>
                    <td>4,200</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="data-section">
        <h3>Page Destinations</h3>
        <table class="page-destinations" data-sankey-layer="1">
            <thead>
                <tr>
                    <th>Page</th>
                    <th>Visitors</th>
                </tr>
            </thead>
            <tbody>
                <tr data-node-id="4">
                    <td>Homepage</td>
                    <td>8,100</td>
                </tr>
                <tr data-node-id="5">
                    <td>Product Catalog</td>
                    <td>5,400</td>
                </tr>
                <tr data-node-id="6">
                    <td>Blog</td>
                    <td>3,800</td>
                </tr>
                <tr data-node-id="7">
                    <td>Contact Page</td>
                    <td>400</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="data-section">
        <h3>Final Outcomes</h3>
        <table class="outcomes" data-sankey-layer="2">
            <thead>
                <tr>
                    <th>Outcome</th>
                    <th>Count</th>
                </tr>
            </thead>
            <tbody>
                <tr data-node-id="8">
                    <td>Purchase</td>
                    <td>3,000</td>
                </tr>
                <tr data-node-id="9">
                    <td>Newsletter Signup</td>
                    <td>2,550</td>
                </tr>
                <tr data-node-id="10">
                    <td>Bounce</td>
                    <td>12,150</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="data-section">
        <h3>How to Use SankeyStone</h3>
        <ol>
            <li>Install the SankeyStone Chrome extension</li>
            <li>Visit this page (or any page with similar data structure)</li>
            <li>Click the SankeyStone extension icon</li>
            <li>View the automatically generated Sankey diagram</li>
            <li>Use "Regenerate" to refresh with current page data</li>
        </ol>
    </div>
    <!-- JavaScript for data manipulation -->
    <script>
        // Store original data for reset
        let originalData = null;
        
        // Function to generate random number between min and max
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Function to format number with commas
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // Function to randomize JSON data
        function randomizeJsonData() {
            const dataElement = document.getElementById('sankey-data');
            if (!dataElement) return;
            
            try {
                // Parse current data
                const data = JSON.parse(dataElement.textContent);
                
                // Store original data if not already stored
                if (!originalData) {
                    originalData = JSON.parse(JSON.stringify(data));
                }
                
                // Randomize link values
                data.links.forEach(link => {
                    link.value = randomInt(200, 5000);
                });
                
                // Update the element with new data
                dataElement.textContent = JSON.stringify(data, null, 4);
                console.log('JSON data randomized');
                
                return data;
            } catch (error) {
                console.error('Error randomizing JSON data:', error);
                return null;
            }
        }
        
        // Function to randomize table data
        function randomizeTableData() {
            // Randomize traffic sources table
            document.querySelectorAll('.traffic-sources tbody tr').forEach(row => {
                const valueCell = row.querySelector('td:nth-child(2)');
                if (valueCell) {
                    valueCell.textContent = formatNumber(randomInt(1000, 8000));
                }
            });
            
            // Randomize page destinations table
            document.querySelectorAll('.page-destinations tbody tr').forEach(row => {
                const valueCell = row.querySelector('td:nth-child(2)');
                if (valueCell) {
                    valueCell.textContent = formatNumber(randomInt(1000, 10000));
                }
            });
            
            // Randomize outcomes table
            document.querySelectorAll('.outcomes tbody tr').forEach(row => {
                const valueCell = row.querySelector('td:nth-child(2)');
                if (valueCell) {
                    valueCell.textContent = formatNumber(randomInt(500, 15000));
                }
            });
            
            console.log('Table data randomized');
        }
        
        // Function to reset data to original values
        function resetData() {
            if (!originalData) return;
            
            // Reset JSON data
            const dataElement = document.getElementById('sankey-data');
            if (dataElement) {
                dataElement.textContent = JSON.stringify(originalData, null, 4);
            }
            
            // Reset table data by reloading the page
            window.location.reload();
        }
        
        // Set up event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const randomizeBtn = document.getElementById('randomize-data');
            const resetBtn = document.getElementById('reset-data');
            
            if (randomizeBtn) {
                randomizeBtn.addEventListener('click', function() {
                    // Add visual feedback
                    randomizeBtn.disabled = true;
                    randomizeBtn.textContent = 'Randomizing...';
                    
                    setTimeout(() => {
                        randomizeJsonData();
                        randomizeTableData();
                        
                        // Update button
                        randomizeBtn.disabled = false;
                        randomizeBtn.textContent = 'ðŸŽ² Randomize Page Data';
                        
                        // Show success message
                        const message = document.createElement('div');
                        message.style.cssText = 'background: #4caf50; color: white; padding: 10px; border-radius: 4px; margin-top: 10px; text-align: center;';
                        message.textContent = 'âœ… Data randomized! Use "Refresh from Page" in the SankeyStone extension.';
                        
                        const controlsSection = document.querySelector('.data-section h3').parentNode;
                        controlsSection.appendChild(message);
                        
                        // Remove message after 5 seconds
                        setTimeout(() => {
                            message.remove();
                        }, 5000);
                        
                    }, 300);
                });
            }
            
            if (resetBtn) {
                resetBtn.addEventListener('click', function() {
                    resetData();
                });
            }
        });
    </script>
</body>
</html>
